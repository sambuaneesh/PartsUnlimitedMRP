| Component Name | Responsibility | Interfaces (key endpoints or methods) | Depends On (other modules) | Technologies (frameworks, DBs, patterns) |
|---|---|---|---|---|
| OrderService (Backend REST API) | Core domain API for catalog, dealers, quotes, orders, shipments/deliveries; validation; persistence; CORS; telemetry; build info ping | HTTP 8080, Actuator 8081; /ping (GET/HEAD); /catalog (GET/POST/PUT/DELETE, /{sku}); /dealers (GET/POST/PUT/DELETE, /{name}); /quotes (GET by id/search, POST/PUT/DELETE); /orders (GET by id/filter, POST ?fromQuote=, PUT, /{id}/events, /{id}/status, DELETE); /shipments (GET/filter, /deliveries, POST, PUT, /{orderId}/events, DELETE) | Repository Layer; MongoDB (default); MongoOperationsWithRetry; Application Insights; (optional) PostgreSQL; Tomcat when deployed as WAR | Java 8; Spring Boot 1.2.x (MVC, Actuator); REST/JSON; Spring Data MongoDB; Gradle; CORS filter; App Insights filter; Retry wrapper pattern |
| Repository Layer (pluggable backends) | Abstracts CRUD and domain queries; coordinates cross-entity validations/joins | Interfaces: CatalogItemsRepository, DealersRepository, QuoteRepository, OrderRepository, ShipmentRepository; RepositoryFactory (ordering.storage=memory/mongodb/postgresql); domain queries (e.g., getOrdersByDealerName) | MongoDB backend; In-memory backend; (optional) PostgreSQL; used by OrderService | Repository pattern; Spring Data MongoTemplate; optional JDBC; ETag params (not enforced) |
| MongoOperationsWithRetry | Resilience and telemetry wrapper for Mongo operations | Methods: findOne, findAll, insert, save, upsert, remove; retries once on DataAccessResourceFailureException caused by SocketTimeoutException; emits RemoteDependencyTelemetry | MongoDB; Application Insights; used by Repository Layer/OrderService | Spring Data MongoOperations; Retry pattern; Application Insights dependency telemetry |
| IntegrationService (Integration Worker) | Scheduled worker that ingests website orders from queue and orchestrates Quote→Order→Shipment via OrderService; publishes product/inventory updates to website | @Scheduled every 30s: CreateOrderProcessTask (orders queue → POST /quotes → POST /orders?fromQuote= → POST /shipments); UpdateProductProcessTask (GET /catalog → enqueue product updates); QueueService.getQueueMessage/addQueueMessage/deleteQueueMessage; Config: mrp.endpoint, visibility timeout 300s | Azure Storage Queues; OrderService (REST via RestTemplate) | Java 8; Spring Boot 1.2.x; Scheduling (@EnableScheduling); Azure Storage SDK 2.0.0; RestTemplate; SLF4J; JSON |
| Web Front End (Static SPA) | User-facing SPA for CRUD and tracking; client-side joins for quotes/orders/deliveries | Hosted on Tomcat (8080; 9080 in VM); baseAddress http://{host}:8080; Data.* methods: catalogGet/save/delete/create; dealersGet/save/create/delete; quotesGet/create/save/delete/getById; ordersGet/create/createFromQuote/save/delete/findById/status/events; deliveriesGet/createFromOrder/save/delete/findById; Uses Google Places Autocomplete | OrderService (CORS-enabled); Tomcat | HTML/JS/CSS; WinJS (MVVM-like); DateJS; Google Maps Places API; WAR on Tomcat 7 |
| MongoDB (Primary DB) | Stores domain data for catalog, dealers, quotes, orders, shipments; seeded sample data | Ports 27017 (DB), 28017 (REST in Docker); Collections: catalog, dealers, quotes, orders, shipments; Indexes on skuNumber, name, quoteId, orderId, status; Seed via MongoRecords.js | Used by OrderService via Repository Layer and MongoOperationsWithRetry | MongoDB; Dockerized image (mongod --rest); JSON/BSON schemas |
| PostgreSQL (Optional schema) | Alternative relational backend (not used by default runtime) | Tables: CatalogItems, Dealers, Quotes, QuoteAdditionalItemRecord, Orders, OrderEvents, PhoneInfo, DeliveryAddress, ShipmentRecords, ShipmentEventInfo; Config postgresql.* | Used optionally by RepositoryFactory/OrderService | PostgreSQL; SQL DDL; normalized schema |
| Azure Storage Queues (Messaging) | External messaging backbone for website integration | Queues: orders (website→integration), product (integration→website); Operations via QueueService: enqueue/dequeue with visibility timeout; Connection string in application.properties | Producers/Consumers: IntegrationService; External website | Azure Storage Queues; At-least-once messaging; JSON payloads |
| Application Insights Telemetry | Observability for HTTP requests, exceptions, and Mongo dependencies | AppInsightsFilter (HTTP request/exception tracking); TelemetryClient (ordering.instrumentationKey); RemoteDependencyTelemetry from MongoOperationsWithRetry; /ping returns build metadata | OrderService; MongoOperationsWithRetry | Azure Application Insights Java SDK; Servlet Filter; Telemetry/metrics |
| Infrastructure & DevOps (Build/Provisioning) | Build, packaging, containerization, and VM provisioning for all deployables | Dockerfiles (db, order, clients); BuildAndRun.sh (maps: db 27017/28017, order 8080, web 80→8080); ARM templates (open ports 8080, 9080, 22); Ansible/Chef/Puppet scripts; Travis CI build/test; deploy_mrp_app.sh (VM) | Web Front End; OrderService; MongoDB; (optional) IntegrationService | Gradle; Docker; OpenJDK/Tomcat; ARM/Azure; Ansible; Chef; Puppet; Travis CI |